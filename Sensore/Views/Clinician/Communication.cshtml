@{
    ViewBag.Title = "Communication";
    Layout = "~/Views/Shared/_ClinicianLayout.cshtml";
}

<div class="p-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold mb-1">Communication</h2>
            <p class="text-muted">Manage and send messages to patients and staff</p>
        </div>
        <div class="notification-bell">
            <i class="bi bi-bell"></i>
            <span class="badge bg-danger rounded-circle position-absolute translate-middle">3</span>
        </div>
    </div>

    <div class="card border-0 shadow-sm rounded-4 p-4">
        <h5 class="fw-semibold mb-3">Patient Communication</h5>
        <p class="text-muted small mb-4">Reply to patient comments and provide feedback on their pressure monitoring data</p>

        <div class="row">
            <!-- patient list -->
            <div class="col-md-4 border-end">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="Search patients..." />
                    <button class="btn btn-outline-secondary"><i class="bi bi-search"></i></button>
                    <button class="btn btn-outline-secondary ms-2">Unread Only</button>
                </div>

                <div class="patient-list">
                    <div class="patient-item active p-3 rounded-3 mb-2 d-flex justify-content-between align-items-center bg-success-subtle">
                        <div>
                            <h6 class="mb-1 fw-semibold">Sarah Johnson</h6>
                            <small class="text-muted">Room 302 • 10 mins ago</small>
                        </div>
                        <span class="badge bg-danger">HIGH</span>
                    </div>
                    <div class="patient-item p-3 rounded-3 mb-2 d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1 fw-semibold">Michael Chen</h6>
                            <small class="text-muted">Room 405 • 1 hour ago</small>
                        </div>
                        <span class="badge bg-warning text-dark">MEDIUM</span>
                    </div>
                    <div class="patient-item p-3 rounded-3 mb-2 d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1 fw-semibold">Emily Rodriguez</h6>
                            <small class="text-muted">Room 201 • 3 hours ago</small>
                        </div>
                        <span class="badge bg-success">LOW</span>
                    </div>
                    <div class="patient-item p-3 rounded-3 mb-2 d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1 fw-semibold">Robert Williams</h6>
                            <small class="text-muted">Room 308 • 5 mins ago</small>
                        </div>
                        <span class="badge bg-danger">HIGH</span>
                    </div>
                </div>
            </div>

            <!-- chat window -->
            <div class="col-md-8">
                <div class="chat-header mb-3 d-flex justify-content-between align-items-center">
                    <div>
                        <h5 class="fw-semibold mb-0">Sarah Johnson</h5>
                        <small class="text-muted">Room 302</small>
                    </div>
                    <span class="badge bg-danger">HIGH RISK</span>
                </div>

                <div class="chat-box bg-light rounded-4 p-3" style="height:420px;overflow-y:auto;">
                    <!-- Patient message -->
                    <div class="chat-message mb-3">
                        <div class="p-3 bg-danger-subtle rounded-4 text-dark" style="max-width:80%;">
                            <p class="mb-2">
                                I've been experiencing increased discomfort in my lower back area,
                                especially after sitting for more than 30 minutes.
                            </p>
                            <small class="text-muted">
                                <i class="bi bi-clock"></i> 2025-11-30 09:15 AM  |
                                <i class="bi bi-bar-chart"></i> Data from Nov 30, 8:00 – 10:00 AM
                            </small>
                        </div>
                    </div>

                    <!-- Clinician reply -->
                    <div class="chat-message mb-3 text-end">
                        <div class="p-3 bg-success text-white rounded-4 d-inline-block text-start" style="max-width:80%;">
                            <p class="mb-2">
                                Thank you for letting me know. I've reviewed your pressure data from this
                                morning and noticed elevated readings in Zone 5. I'm adjusting your
                                repositioning schedule to every 90 minutes.
                            </p>
                            <small class="text-white-50">
                                <i class="bi bi-clock"></i> 2025-11-30 09:45 AM  |
                                <i class="bi bi-bar-chart"></i> Data from Nov 30, 8:00 – 10:00 AM
                            </small>
                        </div>
                        <div class="mt-1"><small class="text-muted">Dr. Sarah Johnson</small></div>
                    </div>

                    <!-- Second patient message -->
                    <div class="chat-message mb-3">
                        <div class="p-3 bg-white rounded-4 border text-dark" style="max-width:80%;">
                            <p class="mb-2">
                                The new cushion is helping, but I still feel some pressure. Should I be concerned?
                            </p>
                            <small class="text-muted">
                                <i class="bi bi-clock"></i> 2025-11-30 10:10 AM
                            </small>
                        </div>
                    </div>
                </div>

                <!-- Reply box -->
                <div class="mt-3">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Type your message..." />
                        <button class="btn btn-success">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .patient-item:hover {
        background-color: #f3f4f6;
        cursor: pointer;
        transition: 0.2s;
    }

    .chat-box::-webkit-scrollbar {
        width: 8px;
    }

    .chat-box::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 4px;
    }
</style>
