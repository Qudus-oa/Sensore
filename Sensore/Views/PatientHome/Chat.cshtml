@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@model List<Sensore.Models.Comment>

<h2>💬 Patient–Clinician Chat</h2>

@if (!Model.Any())
{
    <p>No comments yet. Add your first feedback from the Pressure Distribution page!</p>
}
else
{
    <div class="chat-container">
        @foreach (var comment in Model)
        {
            var isPatient = comment.Author?.ToLower() == "patient";
            <div class="chat-message @(isPatient ? "patient" : "clinician")">
                <div class="message-header">
                    <strong>@comment.Author</strong>
                    <span class="timestamp">@comment.FrameTimestamp.ToLocalTime().ToString("g")</span>
                </div>
                <p>@comment.Text</p>
                <small>🕒 Submitted @comment.CreatedAt.ToLocalTime().ToString("g")</small>
            </div>
        }
    </div>
}

<style>
    .chat-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: 1rem;
    }

    .chat-message {
        padding: 1rem;
        border-radius: 0.8rem;
        box-shadow: 0 1px 4px rgba(0,0,0,0.05);
        max-width: 70%;
    }

        .chat-message.patient {
            background: #e0f2fe;
            align-self: flex-end;
            border-left: 4px solid #3b82f6;
        }

        .chat-message.clinician {
            background: #fef9c3;
            align-self: flex-start;
            border-left: 4px solid #facc15;
        }

    .message-header {
        display: flex;
        justify-content: space-between;
        color: #334155;
        font-weight: 600;
    }

    .timestamp {
        font-size: 0.8rem;
        color: #64748b;
    }

    p {
        margin: 0.5rem 0;
    }

    small {
        color: #64748b;
        font-size: 0.8rem;
    }
</style>
